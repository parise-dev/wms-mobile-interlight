<ion-content class="m-0">
  <ion-grid class="py-2" style="background-color: #000; color: #fff;">
    <ion-row class="px-2 py-2 d-flex justify-content-between align-items-center">
      <i
        class="bi bi-arrow-left-circle"
        style="font-size: 24px;"
        (click)="backHome()"
      ></i>

      <h4 class="pt-2 m-0">Conferência de Volumes</h4>

      <i
        class="bi bi-arrow-clockwise"
        style="font-size: 24px;"
        (click)="reload()"
      ></i>
    </ion-row>
  </ion-grid>
  <div *ngIf="!exibirTable">
    <h6 class="m-3">
      Digite ou bipe o Pedido ou Volume:
      <a class="text-danger float-end" (click)="clear()">limpar</a>
    </h6>

    <div class="m-2 mb-4">
      <div class="input-group m-2 mb-4 me-3">
        <input
          type="text"
          class="form-control me-2"
          placeholder="Número do pedido ou volume"
          [formControl]="orderBip"
          aria-describedby="basic-addon2"
        />
        <div class="input-group-append me-2">
          <button
            (click)="visibleAction = !visibleAction"
            class="btn btn-outline-secondary"
            type="button"
          >
            OK
          </button>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="exibirTable">
    <h6 class="m-3">
      Digite ou Bipe o Pedido a Série do Produto:
      <a class="text-danger float-end" (click)="clear()">limpar</a>
    </h6>

    <div class="m-2 mb-4">
      <div class="input-group m-2 mb-4 me-3">
        <input
          type="text"
          class="form-control me-2"
          placeholder="Número da série"
          [(ngModel)]="volumeBip"
          aria-describedby="basic-addon2"
        />
        <div class="input-group-append me-2">
          <button class="btn btn-outline-secondary" type="button" (click)="confirmeOk()">
            OK
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="row g-2 mx-2" *ngIf="exibirTable">
    <div class="col-6 col-md-3">
      <button class="btn btn-primary w-100">Imprimir nota</button>
    </div>

    <div class="col-6 col-md-3">
      <button class="btn btn-primary w-100">Imprimir etiqueta</button>
    </div>

    <div class="col-6 col-md-3">
      <button (click)="clear()" class="btn btn-danger w-100">Cancelar</button>
    </div>

    <div class="col-6 col-md-3">
      <button class="btn btn-success w-100">Finalizar checkout</button>
    </div>
  </div>

  <hr />

  <h6 *ngIf="visibleAction" class="m-2 mt-4 ms-3 mb-3">Disponíveis para conferir</h6>

  <div class="alert alert-info mt-2 ms-2 me-2" role="alert" *ngIf="visibleItens">
    Nenhum item para conferir
  </div>
  <div class="mx-2 mt-3" *ngIf="exibirTable">
    <div class="border rounded-3 p-3 bg-light-subtle">
      <div class="d-flex align-items-center justify-content-between gap-2">
        <div class="d-flex align-items-center gap-2 flex-wrap">
          <div class="fw-semibold text-uppercase">
            Pedido:
            <span class="text-body-emphasis">{{ itensCheckout.order || '-' }}</span>
          </div>
        </div>
        <div class="text-end">
          <div class="small text-muted">Separador</div>
          <div class="fw-semibold text-uppercase">{{ itensCheckout.separador || '-' }}</div>
        </div>
      </div>
      <div class="mt-3 d-flex flex-wrap gap-3 small text-muted align-items-center">
        <div>
          <div class="fw-semibold text-body">Origem</div>
          <div>XPTO</div>
        </div>
        <div>
          <div class="fw-semibold text-body">Responsável</div>
          <div class="text-success">Helder</div>
        </div>
        <div class="d-flex justify-content-end ms-3">
          <span
            class="badge rounded-pill px-3 py-2 fw-semibold"
            [ngClass]="getStatusBadgeClass(itensCheckout.status)"
          >
            <i class="bi me-1" [ngClass]="getStatusIcon(itensCheckout.status)"></i>
            {{ getStatusLabel(itensCheckout.status) }}
          </span>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="exibirTable" class="table-responsive mt-4 mx-2">
    <table class="table table-bordered align-middle mb-0">
      <tbody>
        <tr
            [ngClass]="
    hasLoteEmConferencia(it)
      ? 'table-warning'
      : 'table-success'
  "
          *ngFor="let it of itensCheckout.items; let i = index"
        >
          <td style="width: 110px;" class="fw-semibold text-end">
            {{ it.itemCode }}
          </td>
          <td class="fw-semibold">{{ it.itemName }}</td>
          <td style="width: 90px;" class="text-end fw-bold">
            {{ it.quantity }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <ion-toast
    [isOpen]="isToastOpen"
    [message]="messageToast"
    [duration]="5000"
    cssClass="toast-custom-class"
    (didDismiss)="setOpen(false)"
  >
  </ion-toast>
</ion-content>